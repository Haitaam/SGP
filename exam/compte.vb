Imports System.Data.OleDb Public Class compte      Private Sub compte_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load         Me.Text = "Gestion des Comptes"         Me.BackColor = Color.WhiteSmoke

        Me.Width = 1200
        Me.Height = 600
        Me.CenterToScreen()

        DataGridView1.Width = Me.Width - 40
        DataGridView1.Height = Me.Height - 220
        DataGridView1.BorderStyle = BorderStyle.None
        DataGridView1.DefaultCellStyle.Font = New Font("Arial", 14)
        DataGridView1.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.Fill
        DataGridView1.ColumnHeadersDefaultCellStyle.BackColor = Color.Black

        DataGridView1.EnableHeadersVisualStyles = False
        DataGridView1.ColumnHeadersDefaultCellStyle.ForeColor = Color.White
        DataGridView1.AlternatingRowsDefaultCellStyle.BackColor = Color.Black

        DataGridView1.CellBorderStyle = DataGridViewCellBorderStyle.None

        DataGridView1.DefaultCellStyle.BackColor = Color.Black
        DataGridView1.DefaultCellStyle.ForeColor = Color.White


          afficher_compte()     End Sub     Public Sub afficher_compte()         connexion()         requete = "SELECT compte.id_compte, typecompte,Membre.id_membre, nom_membre, prenom_membre, compte.login, password " & _                   "FROM compte,Membre " & _                   "where compte.id_membre = Membre.id_membre " & _                   "ORDER BY compte.id_compte ASC;"          Dim da As New OleDbDataAdapter         da = New OleDbDataAdapter(requete, con)         Dim dt As New DataTable         Dim ds As New DataSet         da.Fill(dt)         DataGridView1.DataSource = dt.DefaultView         DataGridView1.Columns(0).Width = 100         con.Close()         Dim nombre As Integer = DataGridView1.Rows.Count         cpt.Text = "Nombre des Comptes : " + nombre.ToString          If (compte_form.type_operation.Text = "Ajouter") Then             DataGridView1.FirstDisplayedScrollingRowIndex = DataGridView1.Rows.Count - 1             DataGridView1.Rows(DataGridView1.Rows.Count - 1).Selected = True         End If         If (compte_form.type_operation.Text = "Modifier") Then             DataGridView1.Rows(Val(compte_form.ligne_modifie.Text)).Selected = True         End If     End Sub      Private Sub Ajouter_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Ajouter.Click         compte_form.type_operation.Text = "Ajouter"         compte_form.idc.Text = Nothing         compte_form.type.Text = Nothing         compte_form.login.Text = Nothing         compte_form.password.Text = Nothing         compte_form.ShowDialog()     End Sub     Private Sub DataGridView1_CellDoubleClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles DataGridView1.CellDoubleClick         Dim i As Integer         i = DataGridView1.CurrentCell.RowIndex         compte_form.idc.Text = DataGridView1.Rows(i).Cells(0).Value.ToString         compte_form.ancien_idc.Text = DataGridView1.Rows(i).Cells(0).Value         compte_form.type.Text = DataGridView1.Rows(i).Cells(1).Value.ToString         compte_form.membre.Text = DataGridView1.Rows(i).Cells(2).Value.ToString         compte_form.login.Text = DataGridView1.Rows(i).Cells(5).Value.ToString         compte_form.password.Text = DataGridView1.Rows(i).Cells(6).Value.ToString         compte_form.ligne_modifie.Text = i         compte_form.type_operation.Text = "Modifier"         compte_form.ShowDialog()     End Sub      Private Sub Supprimer_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Supprimer.Click         Dim i As Integer = DataGridView1.CurrentCell.RowIndex         Dim idf As String = DataGridView1.Rows(i).Cells(0).Value         Dim idp As String = DataGridView1.Rows(i).Cells(2).Value         Dim rep As MsgBoxResult         rep = MsgBox("Etes-vous sûr de supprimer cette compte ? ", vbYesNo + vbQuestion, "Confirmation")         If (rep = vbYes) Then             connexion()             requete = "delete from compte where id_compte = " + idp & _                       "and id_membre = " + idf             cmdsql()             cmd.ExecuteNonQuery()             con.Close()             requete = "select * from compte order by id_compte"             afficher_compte()         End If     End Sub      Private Sub Actualiser_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Actualiser.Click         afficher_compte()     End Sub      Private Sub Rechercher_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Rechercher.Click         Dim nom_a_chercher As String         nom_a_chercher = InputBox("Entrez le nom ou le prenom de membre ou le type de compte : ", "Recherche", "")         connexion()         requete = "SELECT compte.id_compte, typecompte,Membre.id_membre, nom_membre, prenom_membre, compte.login, password " & _                  "FROM compte,Membre " & _                  "where compte.id_membre = Membre.id_membre " & _                  "AND (UCASE(compte.typecompte) LIKE '%" & nom_a_chercher.ToUpper().Replace("'", "''") & "%' " & _                  "OR UCASE(Membre.nom_membre) LIKE '%" & nom_a_chercher.ToUpper().Replace("'", "''") & "%' " & _                  "OR UCASE(Membre.prenom_membre) LIKE '%" & nom_a_chercher.ToUpper().Replace("'", "''") & "%')"          Dim da As New OleDbDataAdapter         da = New OleDbDataAdapter(requete, con)         Dim dt As New DataTable         Dim ds As New DataSet         da.Fill(dt)         DataGridView1.DataSource = dt.DefaultView         DataGridView1.Columns(0).Width = 100         con.Close()         If (DataGridView1.Rows.Count = 0) Then MsgBox("Introuvable...", vbExclamation, "Message")     End Sub      Private Sub ImprimerTousLesServicesToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ImprimerTousLesServicesToolStripMenuItem.Click         DirectCast(PrintPreviewDialog1, Form).WindowState = FormWindowState.Maximized         PrintDocument1.DefaultPageSettings.Landscape = False         PrintPreviewDialog1.ShowDialog()     End Sub      Private Sub PrintDocument1_PrintPage(ByVal sender As System.Object, ByVal e As System.Drawing.Printing.PrintPageEventArgs) Handles PrintDocument1.PrintPage         Dim font_titre As New Font("Arial", 12, FontStyle.Regular)         Dim font_tcolonne As New Font("Arial", 10, FontStyle.Bold)         Dim font_colonne As New Font("Arial", 10, FontStyle.Regular)         Dim ln As Integer = 50         Dim cl As Integer = 50         e.Graphics.DrawString("Gestion des comptes", font_titre, Brushes.Black, cl, ln)         Dim ligne As New Pen(Color.Black)         ln = ln + 20         e.Graphics.DrawLine(ligne, cl, ln, 750, ln)         ln = ln + 20         With e.Graphics             .DrawString("ID", font_tcolonne, Brushes.Black, cl, ln)             .DrawString("Type", font_tcolonne, Brushes.Black, cl + 50, ln)             .DrawString("ID", font_tcolonne, Brushes.Black, cl + 150, ln)             .DrawString("Nom", font_tcolonne, Brushes.Black, cl + 200, ln)             .DrawString("Prenom", font_tcolonne, Brushes.Black, cl + 300, ln)             .DrawString("Login", font_tcolonne, Brushes.Black, cl + 400, ln)             .DrawString("Password ", font_tcolonne, Brushes.Black, cl + 500, ln)         End With         ln = ln + 20         e.Graphics.DrawLine(ligne, cl, ln, 750, ln)         Dim c1, c2, c3, c4, c5, c6, c7 As String         For i = 0 To DataGridView1.Rows.Count - 1             c1 = DataGridView1.Rows(i).Cells(0).Value             c2 = DataGridView1.Rows(i).Cells(1).Value             c3 = DataGridView1.Rows(i).Cells(2).Value             c4 = DataGridView1.Rows(i).Cells(3).Value             c5 = DataGridView1.Rows(i).Cells(4).Value             c6 = DataGridView1.Rows(i).Cells(5).Value             c7 = DataGridView1.Rows(i).Cells(6).Value             With e.Graphics                 .DrawString(c1, font_colonne, Brushes.Black, cl, ln)                 .DrawString(c2, font_colonne, Brushes.Black, cl + 50, ln)                 .DrawString(c3, font_colonne, Brushes.Black, cl + 150, ln)                 .DrawString(c4, font_colonne, Brushes.Black, cl + 200, ln)                 .DrawString(c5, font_colonne, Brushes.Black, cl + 300, ln)                 .DrawString(c6, font_colonne, Brushes.Black, cl + 400, ln)                 .DrawString(c7, font_colonne, Brushes.Black, cl + 500, ln)             End With             ln = ln + 20             e.Graphics.DrawLine(ligne, cl, ln, 750, ln)         Next         e.Graphics.DrawLine(ligne, cl, 1100, 750, 1100)         e.Graphics.DrawString("Gestion des comptes", font_titre, Brushes.Black, cl, 1100)     End Sub      Private Sub DataGridView1_CellContentClick(ByVal sender As System.Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles DataGridView1.CellContentClick      End Sub End Class